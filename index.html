<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="None" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>easy-update-metadata-dataset</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Manual";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> easy-update-metadata-dataset
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href=".">Manual</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#synopsis">SYNOPSIS</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#description">DESCRIPTION</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#arguments">ARGUMENTS</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#installation-and-configuration">INSTALLATION AND CONFIGURATION</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#building-from-source">BUILDING FROM SOURCE</a>
    </li>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">easy-update-metadata-dataset</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" alt="Docs"></a> &raquo;</li><li>Manual</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/DANS-KNAW/easy-update-metadata-dataset/edit/master/docs/index.md"> Edit on DANS-KNAW/easy-update-metadata-dataset</a>
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="easy-update-metadata-dataset">easy-update-metadata-dataset<a class="headerlink" href="#easy-update-metadata-dataset" title="Permanent link">&para;</a></h1>
<h2 id="synopsis">SYNOPSIS<a class="headerlink" href="#synopsis" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code>easy-update-metadata-dataset [--doUpdate] &lt;input-file&gt; [&lt;complex-values-directory&gt;]
</code></pre></div>

<h2 id="description">DESCRIPTION<a class="headerlink" href="#description" title="Permanent link">&para;</a></h2>
<p>Batch-updates XML streams of objects in a Fedora Commons repository.
The command is idempotent, so running it either once or multiple times gives the same result.</p>
<h2 id="arguments">ARGUMENTS<a class="headerlink" href="#arguments" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code>       --doUpdate   Without this argument no changes are made to the repository, the default is a test mode
                           that logs the intended changes
   -h, --help       Show help message
   -v, --version    Show version of this program

   trailing arguments:
       input-file (required)                     The CSV file (RFC4180) with required changes. The first line must
                                                 be &#39;FEDORA_ID,STREAM_ID,XML_TAG,OLD_VALUE,NEW_VALUE&#39;, in that
                                                 order. Additional columns and empty lines are ignored.
       complex-values-directory (not required)   A reference to a directory containing files with the complex
                                                 values. These files are referenced in the input-file.
</code></pre></div>

<p>It is the responsibility of the caller to</p>
<ul>
<li>Provide <em>valid</em> new values in the input file.</li>
<li>Make sure the CSV file is properly stored as UTF8, please export a spreadsheet with open-office for a valid format.</li>
<li>Specify all changes for one dataset in subsequent lines, thus at most one dataset will have inconsistent values
  in case of trouble such as the old value not found or a system failure.</li>
<li>Verify the preconditions for stream <code>AMD</code> and XML tag <code>datasetState</code> which requires a change history.
  Details are documented with <a href="src/test/scala/nl/knaw/dans/easy/umd/TransformerSpec.scala">tests</a>, note that some legitimate preconditions are not implemented and cause a failure,
  not expected preconditions might pass without a warning.</li>
<li>Execute with a representative sample in test mode (without <code>--doUpdate</code>) and review the logged changes.</li>
<li>Change the streams <code>DC</code> and <code>EMD</code> alike as far as applicable.
  In case of <code>EMD,accessRights</code> / <code>DC,rights</code> also</li>
<li>Update <a href="https://github.com/DANS-KNAW/easy-update-metadata-fileitem">file rights</a>.</li>
<li>Call <a href="https://github.com/DANS-KNAW/easy-update-fs-rdb">easy-update-fs-rdb</a>.</li>
<li>Reboot the web-ui to clear the <a href="http://hibernate.org/">hibernate</a> cash.</li>
<li>Call <a href="https://github.com/DANS-KNAW/easy-app/blob/master/tool/task-add-new-license/README.md">easy-task-add-new-license</a> if EMD and/or file rights were changed, the link requires access to the legacy code base.</li>
<li>Update relations such as <code>hasDoi</code>, <code>isMemberOf</code>, collections ...</li>
<li>Call <a href="https://github.com/DANS-KNAW/easy-update-solr-index">easy-update-solr-index</a> if necessary.</li>
</ul>
<p>The legacy code base provides <a href="src/test/resources">CSV examples</a> for the <code>deasy</code> environment.</p>
<h2 id="installation-and-configuration">INSTALLATION AND CONFIGURATION<a class="headerlink" href="#installation-and-configuration" title="Permanent link">&para;</a></h2>
<p>Currently this project is built as an RPM package for RHEL7/CentOS7 and later. The RPM will install the binaries to
<code>/opt/dans.knaw.nl/easy-update-metadata-dataset</code> and the configuration files to <code>/etc/opt/dans.knaw.nl/easy-update-metadata-dataset</code>. </p>
<p>To install the module on systems that do not support RPM, you can copy and unarchive the tarball to the target host.
You will have to take care of placing the files in the correct locations for your system yourself. For instructions
on building the tarball, see next section.</p>
<h2 id="building-from-source">BUILDING FROM SOURCE<a class="headerlink" href="#building-from-source" title="Permanent link">&para;</a></h2>
<p>Prerequisites:</p>
<ul>
<li>Java 8 or higher</li>
<li>Maven 3.3.3 or higher</li>
<li>RPM</li>
</ul>
<p>Steps:</p>
<div class="codehilite"><pre><span></span><code>    git clone https://github.com/DANS-KNAW/easy-update-metadata-dataset.git
    cd easy-update-metadata-dataset
    mvn clean install
</code></pre></div>

<p>If the <code>rpm</code> executable is found at <code>/usr/local/bin/rpm</code>, the build profile that includes the RPM 
packaging will be activated. If <code>rpm</code> is available, but at a different path, then activate it by using
Maven's <code>-P</code> switch: <code>mvn -Pprm install</code>.</p>
<p>Alternatively, to build the tarball execute:</p>
<div class="codehilite"><pre><span></span><code>mvn clean install assembly:single
</code></pre></div>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>

<!--
MkDocs version : 1.3.0
Build Date UTC : 2022-12-11 09:54:58.750331+00:00
-->
